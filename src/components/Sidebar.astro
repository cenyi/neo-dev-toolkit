---
const { t = { navHome: "Home", navAbout: "About", navSettings: "Settings", navLanguage: "Language" } } = Astro.props;
---

<div class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <h2 class="logo">JSON Formatter</h2>
    <button class="toggle-btn" onclick="toggleSidebar()">
      <span class="hamburger"></span>
      <span class="hamburger"></span>
      <span class="hamburger"></span>
    </button>
  </div>
  <nav class="nav-menu">
    <ul>
      <li><a href="/" class="nav-link active">{t.navHome}</a></li>
      <li><a href="/about" class="nav-link">{t.navAbout}</a></li>
      <li><a href="/settings" class="nav-link">{t.navSettings}</a></li>
      <li><a href="#" class="nav-link" onclick="switchLanguage()">{t.navLanguage}</a></li>
    </ul>
  </nav>
</div>

<style>
  .sidebar {
    width: var(--sidebar-width);
    background-color: var(--secondary-color);
    height: 100%;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 100;
    box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
  }

  .sidebar.collapsed {
    width: var(--sidebar-collapsed-width);
  }

  .sidebar-header {
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border-color);
  }

  .sidebar.collapsed .sidebar-header {
    justify-content: center;
  }

  .logo {
    font-size: 1.2rem;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    transition: opacity 0.3s ease;
  }

  .sidebar.collapsed .logo {
    opacity: 0;
    width: 0;
    height: 0;
    overflow: hidden;
  }

  .toggle-btn {
    background: none;
    border: none;
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  .hamburger {
    width: 20px;
    height: 2px;
    background-color: var(--text-color);
    margin: 2px 0;
    transition: 0.3s;
  }

  .nav-menu {
    padding: 20px 0;
    flex-grow: 1;
  }

  .nav-menu ul {
    list-style: none;
  }

  .nav-menu li {
    margin-bottom: 5px;
  }

  .sidebar.collapsed .nav-menu li a span {
    display: none;
  }

  .nav-link {
    display: block;
    padding: 12px 20px;
    text-decoration: none;
    color: var(--text-color);
    transition: all 0.2s;
    display: flex;
    align-items: center;
  }

  .nav-link:hover {
    background-color: rgba(0,0,0,0.05);
  }

  .nav-link.active {
    background-color: var(--primary-color);
    color: white;
  }

  .nav-link i {
    margin-right: 10px;
    min-width: 20px;
    text-align: center;
  }

  .sidebar.collapsed .nav-link span {
    display: none;
  }

  .sidebar.collapsed .nav-link {
    justify-content: center;
    padding: 15px 0;
  }

  .sidebar.collapsed .nav-link i {
    margin-right: 0;
  }
</style>

<script>
  function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('collapsed');

    // 更新全局状态
    window.appState.sidebarCollapsed = sidebar.classList.contains('collapsed');
  }

  function switchLanguage() {
    // 切换语言
    const currentLang = window.appState.lang;
    const newLang = currentLang === 'en' ? 'zh' : 'en';
    window.appState.lang = newLang;

    // 更新URL参数
    const url = new URL(window.location);
    url.searchParams.set('lang', newLang);
    window.location.href = url.toString();
  }

  // 初始化时检查是否需要折叠侧边栏
  if (window.appState && window.appState.sidebarCollapsed) {
    document.getElementById('sidebar').classList.add('collapsed');
  }
</script>